#!/usr/bin/env ruby

require 'reposit'
require 'optparse'

setup = false

OptionParser.new do |opts|
  opts.banner = "Usage: reposit <repository_name> [options]"

  opts.on("-s", "--setup", "Re-setup your GitHub credentials") do |v|
    setup = true
  end
end.parse!

if setup
  path = File.expand_path('~') + '/.reposit'
  `rm #{path} > /dev/null 2>&1`
  Reposit::CredentialsSetter.run
else
  if !ARGV[0]
    puts `reposit --help`
  elsif !Reposit::SetupChecker.check
    Reposit::CredentialsSetter.run
    Reposit::RepositoryMaker.run(ARGV[0])
  else
    Reposit::RepositoryMaker.run(ARGV[0])
  end
end